

[] plumb history fetch to Job
[] return fixed history from a parsed JSON string

[] change who picks job names
[] store history

[] convert from ReportOne to Report interfaces


idea one:
    let front end name jobs
    backend stores in history via it's own ids, but reports in front-end names
    for history reporting, generates yet different front-end job names

    shell will have to keep a history counter
    already keeps front end jobs
    need a way to indicate when a job shouldn't be stored in history
    shell has to find / make history directory when it starts
    shell has to inventory previous history entries to both find new starting
        point, as well as giving front end a way to know what there is

    history ideas
        20120919T122900.0
        2012-09-19.12:29:00.0
        20120919.122900.0

        c-20120919.122900.0-cat_README
        c-20120919.122901.1-ls


$HOME/.plush/session/history/cmd-<date>.<time>.<n>-<cmd>

[] on start up
    mkdir -p $HOME/.plush/session/history
    -- in future need to do some interlock of some sort
    ls -l > history list
    (old, history) <- splitFromBack 500 historyList
    rm old
    initialize counter to last entry of history (or "")

[] front end request "history prior to"
    starting at newest command, read command file, parse
        add to return status
        while return size is rational
    if more to do


[] locking:
    fd <- openefile...
    setLock fd (WriteLock, AbsoluteSeek, 0, 0)
    -- throws if can't set
    -- if anyone ever closes that file (not that fd!) the lock is lost


TASKS
------
[] on start up, mkdir -p $HOME/.plush/session/history
[] initialize stamp
[] on command execution
    [] generate stamp (check for dups)
    [] write CommandItem into file
[] on poll
    [] write OutputItem into file
    [] write FinishedItem, close file
[] remove 'running: false' from FinishItem

-----------
[] on start up get filelist from history dir
[] on history request
    [] read each file, reply with items


[] need a way to mark commands as not to be saved in history
[] newlines between json entries in history files?











